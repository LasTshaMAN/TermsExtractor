Authorities in Pakistan have vowed to deal sternly with Taliban militants who have this month mounted a series of deadly attacks apparently aimed at weakening this country that has close links with neighbouring Afghanistan.   On Monday troops fought pitched battles to regain control of a police academy, on the outskirts of Lahore city, that suspected Taliban militants had taken control of for several hours.  At least eight police cadets died in the attack and nearly 100 were wounded.  'This is an attack on Pakistan.  There are two choices: to either let the Taliban take over your country or to fight it out,' said Rehman Malik, Pakistan’s interior ministry chief.   According to Malik the attack was planned in South Waziristan, where the Tehrik-i-Taliban of Pakistan, led by Baitullah Mehsud, are fighting government forces.   The Taliban (scholars) are made up mostly of fierce Pashtun tribals that straddle the rugged Afghan-Pakistan border.   Witnesses said that some of the assailants had entered the academy disguised as police officers, attacking officers as they gathered for morning training exercises. 'A grenade hit the platoon next to ours . . .  then there was continuous firing for about 20 minutes,' one wounded police officer said.  'A man in light-coloured clothes . . .  stood in front of us, firing at us.  They wanted to do as much damage as possible. 'The attackers then occupied the academy's main building, exchanging gunfire with security forces for several hours until a joint force of army, paramilitary rangers and police stormed it. Imtiaz Gul, a Pakistani political analyst, said the attack underscored the 'ill-preparedness' of police and paramilitary forces in the country. 'The kind of attack that took place is very, very difficult to pre-empt.  There are people who came prepared to kill.  On the other side, you see the kind of response from paramilitary forces.  The entire country has been paying the price for this ill-preparedness,'  Gul said. Armed men ambushed Sri Lanka's cricket team in the city earlier in March, killing six police officers and a driver and wounding several of the players. 'The pattern is much the same; they are very well organised, very well co-ordinated and unfortunately very well executed as well,' P. J.  Mir, a Pakistani political analyst said. 'The Americans have to put their foot down and provide the Pakistani forces with more up-to-date arms, more up-to-date technology to fight these elements of crimes,’’ Mir  told Al Jazeera.  On Saturday, at least 12 shipping containers were damaged in an attack at the Farhad terminal in Peshawar, capital of the North West Frontier Province.  Dozens of fighters fired rockets at the terminal in a bid to disrupt supplies to NATO troops in neighbouring Afghanistan, according to Zahur Khan a police official. Afghan-based United States and NATO forces receive 75  percent of their supplies via routes that pass through Pakistan's Khyber tribal region and the Chaman border crossing - areas where Taliban fighters are believed to be operating. Saturday’s attack came less than a day after a suicide bomber blew up a mosque in Jamrud in the Khyber agency, killing 48 people.  The attack was linked by authorities to operations to protect NATO supplies. Zeina Khodr, Al Jazeera's correspondent in Islamabad, said many of those killed at Jamrud were members of the security forces.  The mosque is near a police checkpoint and 'people in that checkpoint usually pray in this mosque', she said. (*Published under agreement with Al Jazeera. )    